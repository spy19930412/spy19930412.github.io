<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>买卖股票问题与动态规划 | Jane&#39;s blog</title>
  <meta name="author" content="spy19930412">
  
  <meta name="description" content="sometimes ever sometimes never">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="买卖股票问题与动态规划"/>
  <meta property="og:site_name" content="Jane&#39;s blog"/>

  
    <meta property="og:image" content="undefined"/>
  

 <!--  <link href="/favicon.png" rel="icon"> -->
 <link href="/favicon.ico" rel="icon" type="image/x-ico">
  <link rel="alternate" href="/atom.xml" title="Jane&#39;s blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Jane&#39;s blog</a></h1>
  <h2><a href="/">sometimes ever sometimes never</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">存档</a></li>
    
      <li><a href="/about">关于我</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-01-26T09:29:06.000Z"><a href="/2017/01/26/dpProblems/">2017-01-26</a></time>
      
      
  
    <h1 class="title">买卖股票问题与动态规划</h1>
  

    </header>
    <div class="entry">
      
        <p>买卖股票问题与动态规划</p>
<a id="more"></a>
<h3 id="贪心"><a href="#贪心" class="headerlink" title="贪心"></a>贪心</h3><h4 id="55-Jump-Game"><a href="#55-Jump-Game" class="headerlink" title="55. Jump Game"></a><a href="https://leetcode.com/problems/jump-game/?tab=Description" target="_blank" rel="external">55. Jump Game</a></h4><p>Given an array of non-negative integers, you are initially positioned at the first index of the array.</p>
<p>Each element in the array represents your maximum jump length at that position.</p>
<p>Determine if you are able to reach the last index.</p>
<p>For example:<br>A = [2,3,1,1,4], return true.</p>
<p>A = [3,2,1,0,4], return false.</p>
<p>给定起点，每步可以走的步数为A[i],判断能不能走到最后一个</p>
<p>用贪心策略，刚开始 step = A[0]，到下一步 step–, 并且取 step = max(step, A[1])，这样 step 一直是保持最大的能移动步数，局部最优也是全局最优。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">canJump</span><span class="params">(self, nums)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        :type nums: List[int]</div><div class="line">        :rtype: bool</div><div class="line">        """</div><div class="line">        <span class="keyword">if</span> len(nums) == <span class="number">0</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">        step = nums[<span class="number">0</span>]</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(nums)):</div><div class="line">            <span class="keyword">if</span> step &gt; <span class="number">0</span>:</div><div class="line">                step = step <span class="number">-1</span></div><div class="line">                step = max(step, nums[i])</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div></pre></td></tr></table></figure>
<h4 id="45-Jump-Game-II"><a href="#45-Jump-Game-II" class="headerlink" title="45. Jump Game II"></a><a href="https://leetcode.com/problems/jump-game-ii/?tab=Description" target="_blank" rel="external">45. Jump Game II</a></h4><p>Given an array of non-negative integers, you are initially positioned at the first index of the array.</p>
<p>Each element in the array represents your maximum jump length at that position.</p>
<p>Your goal is to reach the last index in the minimum number of jumps.</p>
<p>For example:<br>Given array A = [2,3,1,1,4]</p>
<p>The minimum number of jumps to reach the last index is 2. (Jump 1 step from index 0 to 1, then 3 steps to the last index.)</p>
<p>You can assume that you can always reach the last index.</p>
<p>step: 目前为止的 jump 数</p>
<p>curReach: 从 A[0] 进行 step 次 jump 之后达到的最大范围</p>
<p>maxReach: 从 0~i 这 i+1 个 A 元素中能达到的最大范围</p>
<p>当 curReach &lt; i，说明 step 次 jump 已经不足以覆盖当前第 i 个元素，因此需要增加一次 jump，使之达到记录的 maxReach。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jump</span><span class="params">(self, nums)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        :type nums: List[int]</div><div class="line">        :rtype: int</div><div class="line">        """</div><div class="line">        step = <span class="number">0</span></div><div class="line">        curReach = <span class="number">0</span></div><div class="line">        maxReach = <span class="number">0</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</div><div class="line">            <span class="keyword">if</span> curReach &lt; i:</div><div class="line">                step += <span class="number">1</span></div><div class="line">                curReach = maxReach</div><div class="line">            maxReach = max(maxReach, nums[i] + i)</div><div class="line">        <span class="keyword">return</span> step</div></pre></td></tr></table></figure>
<h3 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h3><h4 id="Best-Time-to-Buy-and-Sell-Stock-I"><a href="#Best-Time-to-Buy-and-Sell-Stock-I" class="headerlink" title="Best Time to Buy and Sell Stock I"></a><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock/?tab=Description" target="_blank" rel="external">Best Time to Buy and Sell Stock I</a></h4><p><mark>tag:dp</mark></p>
<p>Say you have an array for which the i th element is the price of a given stock on day  i .</p>
<p>If you were only permitted to complete at most one transaction (ie, buy one and sell one share of the stock), design an algorithm to find the maximum profit.</p>
<p>给一个数 prices[]，prices[i] 代表股票在第 i 天的售价，求出只做一次交易 (一次买入和卖出) 能得到的最大收益。</p>
<p>只需要找出最大的差值即可，即 max(prices[j] – prices[i]) ，i &lt; j。一次遍历即可，在遍历的时间用遍历 low 记录 prices[o….i] 中的最小值，就是当前为止的最低售价，时间复杂度为 O(n)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">class Solution(object):</div><div class="line">    def maxProfit(self, prices):</div><div class="line">        &quot;&quot;&quot;</div><div class="line">        :type prices: List[int]</div><div class="line">        :rtype: int</div><div class="line">        &quot;&quot;&quot;</div><div class="line">        </div><div class="line">        if len(prices) == 0:</div><div class="line">            return 0</div><div class="line">        low = prices[0]</div><div class="line">        ans = 0</div><div class="line">        for i in range(len(prices)):</div><div class="line">            if prices[i] &lt; low:</div><div class="line">                low = prices[i]</div><div class="line">            if ans &lt; prices[i] - low:</div><div class="line">                ans = prices[i] - low</div><div class="line">        return ans</div></pre></td></tr></table></figure>
<h4 id="122-Best-Time-to-Buy-and-Sell-Stock-II"><a href="#122-Best-Time-to-Buy-and-Sell-Stock-II" class="headerlink" title="122. Best Time to Buy and Sell Stock II"></a><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-ii/?tab=Description" target="_blank" rel="external">122. Best Time to Buy and Sell Stock II</a></h4><p>Say you have an array for which the ith element is the price of a given stock on day i.</p>
<p>Design an algorithm to find the maximum profit. You may complete as many transactions as you like (ie, buy one and sell one share of the stock multiple times). However, you may not engage in multiple transactions at the same time (ie, you must sell the stock before you buy again)</p>
<p>此题和上面一题的不同之处在于不限制交易次数。也是一次遍历即可，只要可以赚就做交易。</p>
<p><mark>tag: greedy</mark></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        :type prices: List[int]</div><div class="line">        :rtype: int</div><div class="line">        """</div><div class="line">        <span class="keyword">if</span> len(prices) == <span class="number">0</span>:</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span></div><div class="line">        ans = <span class="number">0</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(prices)):</div><div class="line">            <span class="keyword">if</span> prices[i] &gt; prices[i - <span class="number">1</span>]:</div><div class="line">                ans += prices[i] - prices[i - <span class="number">1</span>]</div><div class="line">        <span class="keyword">return</span> ans</div></pre></td></tr></table></figure>
<h4 id="123-Best-Time-to-Buy-and-Sell-Stock-III"><a href="#123-Best-Time-to-Buy-and-Sell-Stock-III" class="headerlink" title="123. Best Time to Buy and Sell Stock III"></a><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-iii/?tab=Description" target="_blank" rel="external">123. Best Time to Buy and Sell Stock III</a></h4><p>Say you have an array for which the ith element is the price of a given stock on day i.</p>
<p>Design an algorithm to find the maximum profit. You may complete at most two transactions.</p>
<p>Note:<br>You may not engage in multiple transactions at the same time (ie, you must sell the stock before you buy again).</p>
<p><mark>tag:dp</mark></p>
<p>买卖两次</p>
<p>此题是限制在两次交易内，相对要难一些。容易想到的解决办法是，把 prices[] 分成两部分 prices[0…m] 和 prices[m…length]  ，分别计算在这两部分内做交易的做大收益。由于要做 n 次划分，每次划分可以采用 第一题： Sell Stock I 的解法， 总的时间复杂度为 O(n^2).</p>
<p>但是由于效率过低，运行超时。可以利用动态规划的思想进行改进，保持计算的中间结果，减少重复的计算。</p>
<p>那就是第一步扫描，先计算出子序列 [0,…,i] 中的最大利润，用一个数组保存下来，那么时间是 O(n)。计算方法也是利用第一个问题的计算方法。 第二步是逆向扫描，计算子序列 [i,…,n-1] 上的最大利润，这一步同时就能结合上一步的结果计算最终的最大利润了，这一步也是 O(n)。 所以最后算法的复杂度就是 O(n) 的。</p>
<p>就是说，通过预处理，把上面的函数的复杂度降到 O(1)</p>
<p>动态规划法。以第 i 天为分界线，计算第 i 天之前进行一次交易的最大收益 preProfit[i]，和第 i 天之后进行一次交易的最大收益 postProfit[i]，最后遍历一遍，max{preProfit[i] + postProfit[i]} (0≤i≤n-1) 就是最大收益。第 i 天之前和第 i 天之后进行一次的最大收益求法同 Best Time to Buy and Sell Stock I</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        :type prices: List[int]</div><div class="line">        :rtype: int</div><div class="line">        """</div><div class="line">        n = len(prices)</div><div class="line">        <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span></div><div class="line">        p1 = [<span class="number">0</span>] * n</div><div class="line">        p2 = [<span class="number">0</span>] * n</div><div class="line">        <span class="comment">#正向遍历</span></div><div class="line">        minV = prices[<span class="number">0</span>]</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</div><div class="line">            minV = min(prices[i], minV)</div><div class="line">            p1[i] = max(p1[i - <span class="number">1</span>], prices[i] - minV)</div><div class="line">        </div><div class="line">        <span class="comment">#反向遍历</span></div><div class="line">        maxV = prices[<span class="number">-1</span>]</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</div><div class="line">            maxV = max(prices[i], maxV)</div><div class="line">            p2[i] = max(maxV - prices[i], p2[i + <span class="number">1</span>])</div><div class="line">            </div><div class="line">        res = <span class="number">0</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">            res = max(p1[i] + p2[i], res)</div><div class="line">        <span class="keyword">return</span> res</div></pre></td></tr></table></figure>
<h4 id="123-Best-Time-to-Buy-and-Sell-Stock-III-1"><a href="#123-Best-Time-to-Buy-and-Sell-Stock-III-1" class="headerlink" title="123. Best Time to Buy and Sell Stock III"></a><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-iii/?tab=Description" target="_blank" rel="external">123. Best Time to Buy and Sell Stock III</a></h4><p>参见参考链接</p>
<p><a href="http://www.tuicool.com/articles/rMJZj2" target="_blank" rel="external">参考链接1</a><br><a href="http://blog.csdn.net/ljiabin/article/details/44900389" target="_blank" rel="external">参考链接2</a></p>
<h3 id="回溯"><a href="#回溯" class="headerlink" title="回溯"></a>回溯</h3>
      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/算法/">算法</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/算法/">算法</a>
  </div>

        <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdPic":"","bdStyle":"0","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<nav id="pagination" >
    
    <a href="/2017/02/02/Programming0102/" class="alignleft prev" >上一页</a>
    
    
    <a href="/2017/01/24/Programming0101/" class="alignright next" >下一页</a>
    
    <div class="clearfix"></div>
</nav>

<section id="comment">
  <!-- 多说评论框 start -->
    <div class="ds-thread" ></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'undefined'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- 多说公共JS代码 end -->

</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/blog/">blog</a><small>18</small></li>
  
    <li><a href="/categories/javascript/">javascript</a><small>1</small></li>
  
    <li><a href="/categories/javascript-ES6/">javascript+ES6</a><small>1</small></li>
  
    <li><a href="/categories/python/">python</a><small>1</small></li>
  
    <li><a href="/categories/weixin/">weixin</a><small>1</small></li>
  
    <li><a href="/categories/前端/">前端</a><small>3</small></li>
  
    <li><a href="/categories/博客/">博客</a><small>1</small></li>
  
    <li><a href="/categories/性能优化/">性能优化</a><small>1</small></li>
  
    <li><a href="/categories/毕业设计/">毕业设计</a><small>4</small></li>
  
    <li><a href="/categories/算法/">算法</a><small>7</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Sass/" style="font-size: 12px;">Sass</a> <a href="/tags/blog/" style="font-size: 10px;">blog</a> <a href="/tags/edx/" style="font-size: 10px;">edx</a> <a href="/tags/javascript/" style="font-size: 12px;">javascript</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/前端/" style="font-size: 16px;">前端</a> <a href="/tags/博客/" style="font-size: 12px;">博客</a> <a href="/tags/博客，文章/" style="font-size: 10px;">博客，文章</a> <a href="/tags/微信/" style="font-size: 10px;">微信</a> <a href="/tags/托业/" style="font-size: 10px;">托业</a> <a href="/tags/文章/" style="font-size: 10px;">文章</a> <a href="/tags/旅行/" style="font-size: 10px;">旅行</a> <a href="/tags/毕业设计/" style="font-size: 14px;">毕业设计</a> <a href="/tags/算法/" style="font-size: 20px;">算法</a> <a href="/tags/计算机网络/" style="font-size: 10px;">计算机网络</a> <a href="/tags/读书笔记/" style="font-size: 18px;">读书笔记</a> <a href="/tags/面试心得/" style="font-size: 10px;">面试心得</a>
  </div>
</div>


  <div class="widget tag">
<h3 class="title">友情链接</h3>
<ul class="entry">
<li><a href="https://github.com/spy19930412 " title="spy19930412">my github</a></li>
<li><a href="http://wwj718.github.io/ " title="友情互链">writing for time超级棒</a></li>
<li><a href="http://xueyi1230.github.io/ " title="友情互链">削一个博客一直施工中</a></li>
</ul>
</div>

  <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=1&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=0&uid=2298271483&verifier=401a0bfd&dpc=1"></iframe>
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 spy19930412
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>